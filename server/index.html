<html>
<head>
<script type="text/javascript" src="socket.io.min.js"></script>
<script type="text/javascript" src="jquery-3.2.1.min.js"></script>
<style>
  .player.current {
    background-color: lightyellow;
  }
</style>

</head>
<body>
  <div id='actions'>
  </div>
  <div id='game'>
    <div id='board'></div>
    <div id='pot'></div>
    <div id='players'></div>
  </div>

<script type="text/javascript" charset="utf-8">
  var socket = io.connect('http://localhost:' + 5000);
  socket.on('connect', function() {
    socket.emit('get_full_state');
  });
  socket.on('full_state', function(data) {
    console.log(data);
    $('#board').text(data.board.join(' '));
    $('#pot').text('Pot: ' + data.pots.join(', '));
    player_divs = []
    for (var i = 0; i < data.players.length; ++i) {
      var p = data.players[i];
      player_divs.push('<div class="player ' + (p.is_current ? 'current' : '') + '">'
                       + p.name + ' ' + p.chips + '+' + p.bet + ': ' 
                       + p.hand.join(' ') + ' probs ' + p.probs.join(' ') + '</div>');
    }
    $('#players').html(player_divs.join(''));

    $actions_div = $('#actions')
    $actions_div.html('');
    data.actions.forEach(function(action) {
          $action = $("<input/>").attr('type', 'submit').attr('value', action.text);// type='submit' value='" + action.text + "/>");
          $actions_div.append($action);
          $action.click(function () {
                socket.emit('make_action', {'action_type': action.type});
              });
        });
  });

  /*setInterval(function () {
        console.log('emit next_phase');
        socket.emit('next_phase');
      }, 2000);*/
  $('#next_phase').click(function() {
        console.log('emit next_phase');
        socket.emit('next_phase');
      });
</script>
</body>
</html>
